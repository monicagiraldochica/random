<%
  # your image location will differ
  image="/hpc/containers/rocky_8_xfce_latest.sif"
%>
---
script:
  email: <%= ENV["USER"] %>@mcw.edu
  native:
    - "--ntasks=<%= num_cores %>"
    - "--mem=<%= num_mem %>gb"
    - "--account=<%= account %>"
    - "--partition=pi_bvolkman"
    <%- if email_time_warning -%>
    - "--mail-user=<%= ENV["USER"] %>@mcw.edu"
    - "--mail-type=TIME_LIMIT_90"
    <%- end -%>
  
batch_connect:
  before_script: |
    # Export the module function if it exists
    [[ $(type -t module) == "function"  ]] && export -f module
  template: "vnc"
  websockify_cmd: '/usr/bin/websockify'
  script_wrapper: |
    module purge
    module load apptainer
    cat << "CTRSCRIPT" > container.sh
    export PATH="$PATH:/opt/TurboVNC/bin"
    %s  
    CTRSCRIPT

    # your bindpath will differ
    singularity exec -B /group:/group <%= image %> /bin/bash container.sh
